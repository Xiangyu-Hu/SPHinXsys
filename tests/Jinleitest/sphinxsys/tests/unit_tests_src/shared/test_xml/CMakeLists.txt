STRING( REGEX REPLACE ".*/(.*)" "\\1" CURRENT_FOLDER ${CMAKE_CURRENT_SOURCE_DIR} )
PROJECT("${CURRENT_FOLDER}")

SET(LIBRARY_OUTPUT_PATH ${PROJECT_BINARY_DIR}/lib)
SET(EXECUTABLE_OUTPUT_PATH "${PROJECT_BINARY_DIR}/bin/")
SET(BUILD_INPUT_PATH "${EXECUTABLE_OUTPUT_PATH}/input")
SET(BUILD_OUTPUT_PATH "${EXECUTABLE_OUTPUT_PATH}/output")

file(MAKE_DIRECTORY ${BUILD_INPUT_PATH})
file(MAKE_DIRECTORY ${BUILD_OUTPUT_PATH})

file(COPY ${CMAKE_CURRENT_SOURCE_DIR}/data/test.xml
    DESTINATION ${BUILD_INPUT_PATH})

file(COPY ${CMAKE_CURRENT_SOURCE_DIR}/data/
    DESTINATION ${BUILD_INPUT_PATH})

aux_source_directory(. DIR_SRCS)
ADD_EXECUTABLE(${PROJECT_NAME} ${EXECUTABLE_OUTPUT_PATH} ${DIR_SRCS})
target_link_libraries(${PROJECT_NAME} sphinxsys_2d GTest::gtest GTest::gtest_main)				 
set_target_properties(${PROJECT_NAME} PROPERTIES VS_DEBUGGER_WORKING_DIRECTORY "${EXECUTABLE_OUTPUT_PATH}")

add_test(NAME ${PROJECT_NAME}_particle_relaxation 
		 COMMAND ${PROJECT_NAME} --r=true
		 WORKING_DIRECTORY ${EXECUTABLE_OUTPUT_PATH})
